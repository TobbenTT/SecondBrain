# Optimize MRO Inventory

## Skill ID: K-02
## Version: 1.0.0
## Category: K. Procurement Intelligence
## Priority: P1 - High

---

## Purpose

Optimize Maintenance, Repair, and Operations (MRO) inventory levels for industrial facilities using Min-Max optimization, Economic Order Quantity (EOQ) analysis, criticality-based stocking policies, and obsolescence management. This skill continuously analyzes inventory performance against maintenance demand patterns, identifies excess and dead stock, recommends reorder parameters, and ensures the right balance between service level (parts availability when needed) and capital efficiency (minimizing tied-up working capital).

MRO inventory optimization is one of the most significant and yet most overlooked opportunities in industrial operations. The Corporate Pain Points Research Report documents the scale of the problem:

**Pain Point P-03: 15-25% of MRO inventory is excess, obsolete, or slow-moving.** This statistic, consistent across multiple industry surveys (Plant Engineering Magazine, 2022; Deloitte MRO Study, 2021; Aberdeen Group), means that a plant with $50M in MRO inventory is carrying $7.5M-$12.5M in parts that will likely never be used -- while simultaneously experiencing stockouts on critical items that halt production. The paradox of MRO inventory is that organizations are simultaneously overstocked and understocked: overstocked on low-criticality items (often accumulated through years of "just in case" ordering) and understocked on high-criticality items (because the budget is consumed by carrying excess).

The financial impact extends far beyond the carrying cost of excess inventory. SMRP Best Practice 5.5.1 establishes that carrying cost of MRO inventory is typically 25-35% of item value per year (storage, insurance, handling, obsolescence, capital cost). For a $50M inventory, this represents $12.5M-$17.5M per year in carrying costs alone. Meanwhile, stockouts on critical items drive emergency procurement at 3-10x premium pricing, expediting charges, production losses of $50K-$500K per hour for major equipment, and maintenance craftworkers waiting idle ("wrench time" degradation). Industry data from SMRP shows that best-in-class organizations maintain MRO inventory at 0.5-0.8% of Replacement Asset Value (RAV), while median performers are at 1.5-2.5% -- a gap that represents millions of dollars in tied-up capital.

This skill takes the initial spare parts list generated by K-01 (generate-initial-spares-list) as its baseline and continuously optimizes it based on actual consumption data, changing maintenance strategies, equipment modifications, and market conditions. It transforms MRO inventory management from a static catalog into a dynamic, data-driven system that adapts to operational reality.

---

## Intent & Specification

The AI agent MUST understand and execute the following core objectives:

1. **Consumption Pattern Analysis**: Analyze actual spare parts consumption data from CMMS work orders and warehouse transactions to identify true demand patterns. Many spare parts have intermittent or lumpy demand that does not follow standard normal distribution assumptions. The agent must apply appropriate demand forecasting methods: Croston's method for intermittent demand, bootstrapping for items with very few historical observations, and standard moving average/exponential smoothing for fast-moving items.

2. **Min-Max Parameter Optimization**: Calculate optimal Min (reorder point) and Max (maximum stock level) parameters for every stocked item based on demand variability, lead time variability, criticality (VED classification), and target service level. Parameters must be recalculated periodically (monthly for A items, quarterly for B items, annually for C items) as demand patterns evolve.

3. **EOQ Analysis**: Apply Economic Order Quantity modeling to determine optimal order quantities that balance ordering costs (purchase order processing, receiving, quality inspection) against carrying costs (storage, insurance, obsolescence, capital). EOQ is particularly impactful for high-volume C items where order frequency can be significantly reduced through batch ordering.

4. **Criticality-Based Stocking Policies**: Apply differentiated inventory policies based on VED-ABC classification (from K-01). Vital-A items get the highest investment in availability; Desirable-C items may be moved to non-stock (purchase on demand). The agent must continuously validate that criticality classifications remain current as equipment criticality changes due to process modifications or reliability improvements.

5. **Excess & Obsolete Inventory Identification**: Systematically identify inventory items that are excess (stock level far exceeds reasonable demand) or obsolete (equipment has been decommissioned, superseded, or modified). Generate disposition recommendations: return to vendor, transfer to other site, sell to third party, write off and dispose.

6. **Inventory Health Dashboard**: Generate KPI dashboards tracking inventory performance: turnover ratio, fill rate (service level), stockout events, excess and obsolete percentage, emergency purchase orders, dead stock age analysis, and inventory value trend.

7. **Obsolescence Management**: Proactively identify items at risk of obsolescence due to vendor discontinuation, technology changes, or equipment modification plans. Generate procurement alerts for last-time-buy opportunities and identify alternative/substitute parts before current sources become unavailable.

8. **Continuous Improvement Loop**: Feed inventory performance data back to the maintenance strategy (J-01) to validate spare parts requirements from FMECA. If actual consumption significantly differs from FMECA predictions, flag for strategy review. If stockouts cause production losses, flag for criticality reassessment.

---

## Trigger / Invocation

```
/optimize-mro-inventory
```

**Aliases**: `/mro-optimization`, `/inventory-optimization`, `/spare-parts-optimization`, `/optimizar-inventario-mro`

**Primary Trigger Commands:**
- `optimize-mro-inventory analyze --site [site-code] --period [months]`
- `optimize-mro-inventory minmax-update --site [site-code]`
- `optimize-mro-inventory excess-review --site [site-code] --threshold [months-of-supply]`
- `optimize-mro-inventory obsolescence-scan --site [site-code]`
- `optimize-mro-inventory kpi-report --site [site-code] --period [monthly|quarterly|annual]`
- `optimize-mro-inventory budget --site [site-code] --target [amount|percentage]`
- `optimize-mro-inventory eoq-analysis --site [site-code] --category [A|B|C|all]`
- `optimize-mro-inventory benchmark --site [site-code] --industry [sector]`

**Automatic Triggers:**
- Monthly: Min-Max parameter recalculation for A items
- Quarterly: Full inventory analysis and KPI report generation
- When stockout event occurs: Immediate analysis and corrective recommendation
- When equipment is decommissioned: Obsolescence scan for associated spare parts
- When MOC is approved (from I-05): Spare parts impact assessment
- Annual: Comprehensive inventory health review and obsolescence management
- Budget cycle: Annual MRO inventory budget optimization

**Event-Driven Triggers:**
- Equipment criticality change (from analyze-equipment-criticality)
- Maintenance strategy revision (from develop-maintenance-strategy, J-01)
- Vendor notification of part discontinuation
- Significant price change on key items (>15% increase/decrease)
- New equipment commissioning (spare parts from K-01 entering inventory)
- Warehouse space constraint notification

---

## Input Requirements

### Required Inputs

| Input | Source | Required | Description |
|-------|--------|----------|-------------|
| Current Inventory Master | mcp-erp (SAP MM / Maximo) | Yes | Complete material master with quantities on hand, unit costs, MRP parameters, and material status |
| Transaction History | mcp-erp | Yes | Inventory transactions (issues, receipts, returns, adjustments) for past 12-24 months minimum |
| CMMS Work Order Data | mcp-cmms | Yes | Work orders with material usage: which parts were consumed, for which equipment, failure mode coded |
| Equipment Register | mcp-cmms / mcp-sharepoint | Yes | Active equipment list with criticality ratings and operational status |
| VED-ABC Classification | generate-initial-spares-list (K-01) | Yes | Current VED-ABC classification of all inventory items |

### Recommended Inputs

| Input | Source | Description |
|-------|--------|-------------|
| Vendor Lead Time Data | mcp-erp (purchasing records) | Actual vs. quoted lead times for recent purchase orders |
| Purchase Order History | mcp-erp | PO history for pricing trends, supplier performance, and emergency order identification |
| Maintenance Strategy | develop-maintenance-strategy (J-01) | FMECA-predicted consumption rates for validation against actuals |
| Equipment Modification Plans | manage-moc-workflow (I-05) | Upcoming MOCs that may affect spare parts requirements |
| Equipment Decommissioning Plans | Client / agent-project | Equipment being retired or replaced (obsolescence input) |
| Budget Constraints | agent-finance | MRO inventory budget limits and capital cost of carrying inventory |
| Warehouse Capacity Data | Warehouse management | Physical storage constraints (shelf space, floor space, special storage) |

### Optional Inputs

| Input | Source | Description | Default if Absent |
|-------|--------|-------------|-------------------|
| Industry Benchmark Data | SMRP / Plant Engineering | Industry KPI benchmarks for inventory performance | SMRP published benchmarks |
| Corporate Inventory Policy | Client | Corporate mandates for service levels, write-off thresholds | SMRP best practice defaults |
| Commodity Price Indices | Market data | Price trends for steel, copper, rubber, etc. | Flat pricing assumed |
| Multi-Site Inventory Data | mcp-erp | Inventory at sister sites for potential inter-site transfer | Single-site optimization |

---

## Output Specification

### Primary Output: MRO Inventory Optimization Report (.xlsx)

**Filename:** `{SiteCode}_MRO_Optimization_Report_v{version}_{date}.xlsx`

**Workbook Structure:**

#### Sheet 1: "Executive Dashboard"
- Inventory KPI scorecard with traffic-light indicators
- Total inventory value and trend (12-month rolling)
- Excess/obsolete value and percentage
- Service level (fill rate) current vs. target
- Top 10 stockout events with production impact
- Key recommendations (max 5 actions with highest ROI)

#### Sheet 2: "Inventory Health Analysis"
| Metric | Current | Target | Industry Benchmark | Status |
|--------|---------|--------|-------------------|--------|
| Total MRO Inventory Value | $XX.XM | $XX.XM | 0.5-1.5% RAV | RAG |
| Inventory as % of RAV | X.XX% | X.XX% | 0.5-1.5% | RAG |
| Inventory Turnover Ratio | X.Xx | 1.0-2.0x | 1.0-2.5x | RAG |
| Fill Rate (Service Level) | XX.X% | >95% | 95-98% | RAG |
| Stockout Events (12 months) | XX | <12 | <6 | RAG |
| Emergency PO Percentage | XX.X% | <5% | <3% | RAG |
| Excess Inventory (>24 months supply) | $XX.XM (XX%) | <5% | <3% | RAG |
| Obsolete Inventory (no demand >36 months) | $XX.XM (XX%) | <2% | <1% | RAG |
| Dead Stock (no movement >24 months) | $XX.XM (XX%) | <5% | <3% | RAG |
| Carrying Cost (annual) | $XX.XM | -- | 25-35% of inventory value | INFO |

#### Sheet 3: "Min-Max Recommendations"
| Material # | Description | VED | ABC | Current Min | Current Max | Recommended Min | Recommended Max | Change Rationale | Annual Impact ($) |
|-----------|-------------|-----|-----|------------|------------|----------------|----------------|-----------------|-------------------|

#### Sheet 4: "EOQ Analysis"
| Material # | Description | Annual Demand | Unit Cost | Order Cost | Carrying Rate | Current Order Qty | EOQ | Savings/Year | Recommended |
|-----------|-------------|--------------|-----------|-----------|--------------|------------------|-----|-------------|-------------|

#### Sheet 5: "Excess Inventory"
| Material # | Description | Qty on Hand | Avg Annual Demand | Months of Supply | Excess Qty | Excess Value ($) | Last Transaction | Disposition Recommendation |
|-----------|-------------|------------|------------------|-----------------|-----------|-----------------|-----------------|---------------------------|

#### Sheet 6: "Obsolete Inventory"
| Material # | Description | Qty on Hand | Value ($) | Equipment Tag | Equipment Status | Last Demand Date | Reason for Obsolescence | Disposition | Expected Recovery ($) |
|-----------|-------------|------------|----------|--------------|-----------------|-----------------|------------------------|------------|---------------------|

#### Sheet 7: "Stockout Analysis"
| Date | Material # | Description | Equipment Tag | Impact | Root Cause | Emergency PO Cost | Production Loss ($) | Corrective Action |
|------|-----------|-------------|--------------|--------|-----------|------------------|--------------------|--------------------|

#### Sheet 8: "Consumption vs. FMECA Validation"
| Material # | Description | FMECA Predicted Annual | Actual Annual | Variance (%) | Action Required |
|-----------|-------------|----------------------|--------------|-------------|----------------|
Items where actual consumption deviates >30% from FMECA prediction trigger maintenance strategy review.

#### Sheet 9: "Obsolescence Risk Register"
| Material # | Description | Risk Factor | Vendor Status | Alternative Part | Action Required | Due Date |
|-----------|-------------|-------------|--------------|-----------------|----------------|----------|

#### Sheet 10: "Optimization Summary & ROI"
| Optimization Action | Current Annual Cost | Optimized Annual Cost | Annual Savings | Implementation Effort | ROI |
|--------------------|--------------------|-----------------------|---------------|----------------------|-----|
| Min-Max parameter update | $X.XM carrying cost | $X.XM | $XXK | Low (system update) | XX:1 |
| Excess inventory disposition | $X.XM carrying cost | $0 | $XXK + recovery | Medium (disposal process) | XX:1 |
| EOQ implementation | $X.XM ordering cost | $X.XM | $XXK | Low (system update) | XX:1 |
| Criticality reclassification | $X.XM (over-stocking low crit) | $X.XM | $XXK | Medium (review process) | XX:1 |
| **Total Optimization** | -- | -- | **$X.XM** | -- | -- |

### Formatting Standards
- Header row: Bold, dark navy background (#003366), white font
- KPI cells: Conditional formatting with RAG indicators (Green: target met, Amber: within 10%, Red: >10% deviation)
- Excess items: Orange row highlight
- Obsolete items: Red row highlight
- Stockout events: Red text for production impact values
- All monetary values: USD with thousand separators and 2 decimal places
- All percentages: 1 decimal place
- Trend arrows for KPIs: Up-green, flat-amber, down-red

---

## Methodology & Standards

### Primary Standards

| Standard | Application |
|----------|-------------|
| **SMRP Best Practice 5.5** | MRO Inventory Management: benchmark targets for inventory value, turnover, service levels |
| **SMRP Best Practice 5.5.1** | MRO Inventory Value as % of RAV: 0.5-1.5% for well-managed plants |
| **SMRP Best Practice 5.5.2** | MRO Inventory Accuracy: >95% cycle count accuracy |
| **SMRP Best Practice 5.5.3** | MRO Storeroom Service Level: >95% fill rate for planned work |
| **ISO 55001:2014** | Asset management decision-making: risk-based approach to inventory investment |
| **APICS/ASCM CSCP** | Supply chain planning methodologies: demand forecasting, inventory optimization |

### Key Optimization Methodologies

**Min-Max Optimization:**
```
Min (Reorder Point) = (Avg Daily Demand x Lead Time in Days) + Safety Stock
Max (Maximum Stock) = Min + EOQ (or Min + Optimal Lot Size)
Safety Stock = Z-score(SL) x Std Dev(Demand) x Sqrt(Lead Time + Review Period)

Where:
  Z-score(SL) maps to target service level:
    99.0% -> Z = 2.33 (Vital items)
    97.0% -> Z = 1.88 (Essential items)
    95.0% -> Z = 1.65 (Important items)
    90.0% -> Z = 1.28 (Standard items)
    80.0% -> Z = 0.84 (Low-priority items)
```

**Economic Order Quantity (EOQ):**
```
EOQ = Sqrt(2 x D x S / H)

Where:
  D = Annual demand (units)
  S = Fixed ordering cost per order ($50-$200 typical for industrial PO)
  H = Annual holding/carrying cost per unit = Unit Cost x Carrying Rate (25-35%)
```

**Croston's Method (Intermittent Demand):**
For spare parts with sporadic consumption (>50% of periods with zero demand):
```
1. Track demand size (when demand occurs) and inter-arrival time separately
2. Apply exponential smoothing to both series independently
3. Forecast = Smoothed Demand Size / Smoothed Inter-Arrival Time
4. This avoids the systematic bias of standard methods applied to lumpy data
```

**Inventory Value Stratification (Pareto):**
```
Typical industrial MRO inventory distribution:
  - 15-20% of items (A class) = 75-80% of total value
  - 20-25% of items (B class) = 15-20% of total value
  - 55-65% of items (C class) = 3-5% of total value
```

### Industry Benchmarks

| Metric | World-Class | Top Quartile | Median | Bottom Quartile |
|--------|------------|--------------|--------|-----------------|
| MRO Inventory Value (% RAV) | 0.5-0.8% | 0.8-1.2% | 1.5-2.5% | >3.0% |
| Inventory Turnover Ratio | 2.0-3.0x | 1.5-2.0x | 0.8-1.2x | <0.6x |
| Fill Rate (Service Level) | >98% | 95-98% | 90-95% | <88% |
| Stockout-Driven Emergency POs | <2% | 2-5% | 8-15% | >20% |
| Excess Inventory (>24mo supply) | <3% | 3-5% | 10-15% | >20% |
| Obsolete Inventory | <1% | 1-3% | 5-10% | >12% |
| Inventory Accuracy (cycle count) | >99% | 97-99% | 93-97% | <90% |
| Average Days of Supply (fast movers) | 30-60 days | 60-90 days | 90-180 days | >180 days |

### Pain Points Addressed

| Pain Point | Statistic | How Addressed | Expected Impact |
|-----------|-----------|---------------|----------------|
| P-03: Excess Inventory | 15-25% excess MRO inventory | Systematic identification and disposition of excess/obsolete items | Reduce excess to <5% (60-80% reduction) |
| D-04: Spares Arrive Late | 30-40% late for commissioning | Min-Max optimization ensures reorder before stockout | Reduce stockouts by >70% |
| SM-01: KPI Variance | 3-5x variance in maintenance cost | Inventory optimization directly reduces material cost component | 15-25% reduction in material costs |
| M-04: Data Underutilization | 20-30% of operational data used | Consumption analytics extract value from transaction data | Data-driven inventory decisions |

---

## Step-by-Step Execution

### Phase 1: Data Extraction & Baseline Assessment (Steps 1-4)

**Step 1: Extract Current Inventory Data**
1. Query mcp-erp for complete material master: material number, description, unit of measure, unit cost, quantity on hand, MRP parameters (Min, Max, Reorder Point, Lot Size), material status (active/blocked/obsolete)
2. Query mcp-erp for transaction history (24 months minimum): goods issues, goods receipts, returns, transfers, adjustments
3. Query mcp-cmms for work order material usage: material consumed per work order, equipment tag, failure code, work order type (PM, CM, emergency)
4. Query mcp-erp for purchase order history: PO dates, promised delivery dates, actual delivery dates, prices, vendors
5. Validate data quality: check for orphan materials (in inventory but not linked to equipment), ghost records (material master entries with no physical stock), and inconsistencies between ERP and physical inventory
6. Generate baseline inventory snapshot: total items, total value, VED-ABC distribution

**Step 2: Analyze Consumption Patterns**
1. For each material item, calculate:
   - Average monthly demand (last 12 months and last 24 months)
   - Demand variability (coefficient of variation = std dev / mean)
   - Demand frequency (% of months with non-zero demand)
   - Demand trend (increasing, stable, declining)
2. Classify demand patterns:
   - **Fast-moving (FM):** Demand in >9 of 12 months, CV < 0.5
   - **Slow-moving (SM):** Demand in 4-9 of 12 months, or CV 0.5-1.0
   - **Intermittent (IM):** Demand in 1-3 of 12 months, or CV > 1.0
   - **Non-moving (NM):** Zero demand in last 12 months
   - **Dead stock (DS):** Zero demand in last 24+ months
3. For each category, select appropriate forecasting method:
   - FM: Exponential smoothing or moving average
   - SM: Weighted exponential smoothing with seasonality check
   - IM: Croston's method or bootstrapping
   - NM/DS: No forecast (disposition analysis)
4. Generate demand forecast for next 12 months by item

**Step 3: Analyze Lead Time Performance**
1. For each vendor, calculate:
   - Average actual lead time vs. quoted lead time
   - Lead time variability (standard deviation)
   - On-time delivery rate (% delivered within quoted lead time)
   - Trend in lead time (improving, stable, worsening)
2. For each material item:
   - Determine effective lead time = actual average + safety factor
   - Safety factor = 1.0 (reliable vendor, OTD >90%) to 2.0 (unreliable vendor, OTD <70%)
3. Identify items with deteriorating lead time performance (early warning for supply chain risk)
4. Flag items where lead time exceeds review period + safety stock coverage (stockout risk)

**Step 4: Calculate Baseline Inventory Health KPIs**
1. Calculate all KPIs per the Methodology section
2. Compare each KPI against industry benchmarks
3. Identify top improvement opportunities:
   - Largest excess value items
   - Highest stockout frequency items
   - Lowest turnover items (excluding insurance spares)
   - Highest carrying cost items
4. Generate baseline assessment summary: current state, gap to benchmark, improvement opportunity estimate

### Phase 2: Optimization Analysis (Steps 5-8)

**Step 5: Optimize Min-Max Parameters**
1. For each stocked item (excluding insurance spares):
   - Determine target service level from VED-ABC classification matrix
   - Calculate safety stock using the appropriate demand distribution
   - Calculate reorder point (Min) = demand during lead time + safety stock
   - Calculate maximum stock (Max) = Min + EOQ (or Min + 3-month demand, whichever is more practical)
2. Compare calculated parameters against current ERP settings:
   - Items where current Min is too low (stockout risk)
   - Items where current Max is too high (excess inventory accumulation)
   - Items with no MRP parameters set (uncontrolled)
3. Quantify the impact of parameter changes:
   - Reduction in safety stock for over-protected items
   - Increase in safety stock for under-protected items
   - Net change in average inventory value
4. Generate Min-Max recommendation table with change justification for each item

**Step 6: Perform EOQ Analysis**
1. For fast-moving items (A and B class):
   - Calculate EOQ using standard formula
   - Compare EOQ against current order quantities
   - Calculate annual savings from EOQ adoption (reduced ordering cost + reduced carrying cost)
2. For items with quantity discounts:
   - Calculate total cost at each price break
   - Determine if price break quantity is economically justified
3. For items with shelf life limitations:
   - Constrain maximum order quantity to shelf life x demand rate
4. Generate EOQ recommendation table with expected annual savings

**Step 7: Identify and Classify Excess & Obsolete Inventory**
1. **Excess Inventory Analysis:**
   - For each item: calculate months of supply = quantity on hand / average monthly demand
   - Flag items with >24 months of supply as "excess"
   - Flag items with >36 months of supply as "significant excess"
   - Calculate excess value: (qty on hand - 24 months demand) x unit cost
   - Disposition recommendations:
     - Transfer to sister site (if applicable)
     - Return to vendor (if return policy exists)
     - Sell to third-party broker (typical recovery: 10-30% of cost)
     - Write off and dispose (last resort)
2. **Obsolete Inventory Analysis:**
   - Cross-reference material master with active equipment register
   - Identify parts linked to equipment that has been:
     - Decommissioned (equipment removed from service)
     - Modified (equipment changed, old parts no longer compatible)
     - Superseded (vendor replaced with new model, different parts)
   - Flag as obsolete with clear disposition plan
3. **Dead Stock Analysis:**
   - Items with zero transactions (no issues, no receipts) for >24 months
   - Validate: is the item an insurance spare (legitimately zero consumption)?
   - If not insurance spare: reclassify and generate disposition recommendation
4. Calculate total recoverable value from excess/obsolete disposition

**Step 8: Perform Criticality Reclassification Review**
1. Compare current VED classification against actual consumption and impact data:
   - Items classified as Vital but with zero demand in 24 months: validate (insurance spare?) or reclassify
   - Items classified as Desirable but with emergency stockout events: reclassify upward
2. Compare current ABC classification against actual annual consumption value:
   - Reclassify based on actual data (initial classification was based on estimates)
3. Identify items where equipment criticality has changed:
   - Equipment upgraded to Criticality A: spare parts may need reclassification to V
   - Equipment downgraded or decommissioned: spare parts may need reclassification to D
4. Generate reclassification recommendations with inventory policy implications

### Phase 3: Reporting & Implementation (Steps 9-12)

**Step 9: Generate Inventory KPI Dashboard**
1. Calculate all KPIs for current period
2. Compare against previous period (trend analysis)
3. Compare against industry benchmarks
4. Generate visualizations: KPI gauges, trend charts, Pareto charts
5. Identify top 5 improvement actions with highest ROI
6. Publish dashboard to mcp-excel for distribution

**Step 10: Generate Optimization Action Plan**
1. Consolidate all recommendations into a prioritized action plan:
   - Priority 1: Min-Max parameter updates (immediate, system update only)
   - Priority 2: Excess inventory disposition (30-60 days, procurement team)
   - Priority 3: EOQ implementation (30 days, system update)
   - Priority 4: Criticality reclassification (60-90 days, engineering review)
   - Priority 5: Obsolescence management actions (90-180 days, procurement + engineering)
2. Calculate expected financial impact of each action:
   - Carrying cost reduction
   - Stockout risk reduction (in terms of avoided production losses)
   - Working capital released
   - One-time recovery from disposition
3. Generate executive summary with total optimization opportunity

**Step 11: Upload Optimized Parameters to ERP**
1. Prepare Min-Max parameter update file compatible with mcp-erp
2. Include approval workflow: parameter changes above threshold require management approval
   - Changes affecting >$10K in safety stock: Maintenance Manager approval
   - Changes affecting >$100K: Plant Manager approval
   - Disposition of >$50K in obsolete inventory: Finance Manager approval
3. Implement approved parameter changes via mcp-erp
4. Verify parameter updates took effect correctly

**Step 12: Feed Back to Maintenance Strategy**
1. Generate FMECA validation report:
   - Items where actual consumption >>  FMECA prediction (potential under-maintenance)
   - Items where actual consumption << FMECA prediction (potential over-maintenance)
   - Items consumed for failure modes not in FMECA (emerging failure modes)
2. Share findings with develop-maintenance-strategy (J-01) for strategy update consideration
3. Update VED-ABC classification in generate-initial-spares-list (K-01) baseline
4. Notify model-opex-budget of revised annual material cost forecast

---

## Quality Criteria

| Criterion | Metric | Target | Minimum Acceptable |
|-----------|--------|--------|-------------------|
| Min-Max Coverage | % of active items with optimized MRP parameters | >95% | >85% |
| Service Level Achievement | Fill rate for planned maintenance requests | >95% | >92% |
| Stockout Frequency | Stockout events per month (critical items) | <2 | <5 |
| Excess Inventory Reduction | % reduction in excess inventory value per year | >30% | >15% |
| Obsolete Inventory Identification | % of obsolete items identified and dispositioned | >90% annually | >75% |
| Inventory Turnover Improvement | Year-over-year turnover ratio improvement | >10% | >5% |
| EOQ Implementation | % of A-class items using optimized order quantities | >80% | >60% |
| Carrying Cost Reduction | Year-over-year reduction in carrying costs | >10% | >5% |
| FMECA Validation Coverage | % of items validated against actual consumption | >80% | >60% |
| Data Accuracy | Inventory record accuracy (cycle count) | >97% | >95% |
| Emergency PO Reduction | Year-over-year reduction in emergency purchases | >25% | >15% |
| Report Timeliness | KPI reports delivered on schedule | 100% | >95% |
| Optimization ROI | Documented savings vs. effort invested | >5:1 | >3:1 |
| Parameter Update Frequency | Min-Max recalculated per schedule | 100% compliance | >90% |

---

## Inter-Agent Dependencies

### Upstream Dependencies (Inputs FROM other agents)

| Agent/Skill | Dependency | Description |
|-------------|------------|-------------|
| `generate-initial-spares-list` (K-01) | Baseline inventory | Initial VED-ABC classified spare parts list that establishes the starting inventory |
| `develop-maintenance-strategy` (J-01) | FMECA data | Predicted consumption rates from maintenance strategy for validation against actuals |
| `analyze-equipment-criticality` | Criticality changes | Equipment criticality changes trigger spare parts reclassification |
| `manage-moc-workflow` (I-05) | Equipment changes | MOCs affecting equipment trigger spare parts review (new parts, obsolete parts) |
| `agent-maintenance` | Consumption data | Maintenance work orders provide actual spare parts consumption data |
| `agent-finance` | Budget parameters | Carrying cost rate, capital cost, and MRO budget constraints |

### Downstream Dependencies (Outputs TO other agents)

| Agent/Skill | Dependency | Description |
|-------------|------------|-------------|
| `model-opex-budget` | Material cost forecast | Optimized annual material consumption forecast feeds OPEX model |
| `track-long-lead-procurement` (K-03) | Reorder alerts | Items reaching reorder point with long lead times are flagged for tracking |
| `benchmark-maintenance-kpis` (J-04) | KPI data | Inventory KPIs feed into overall maintenance benchmarking dashboard |
| `model-rampup-trajectory` (H-04) | Readiness input | Spare parts availability feeds into ramp-up trajectory readiness assessment |
| `develop-maintenance-strategy` (J-01) | Feedback loop | Consumption validation data triggers maintenance strategy review |
| `identify-improvement-opportunities` (S-02) | Cost data | Inventory optimization opportunities feed continuous improvement pipeline |

---

## MCP Integrations

### mcp-erp
```yaml
name: "mcp-erp"
server: "@vsc/erp-mcp"
purpose: "Primary data source for inventory and procurement data"
capabilities:
  - Read material master data (descriptions, costs, MRP parameters, status)
  - Read inventory transaction history (goods movements, adjustments)
  - Read purchase order history (pricing, lead times, vendor performance)
  - Update MRP parameters (Min, Max, Reorder Point, Lot Size)
  - Generate purchase requisitions for items reaching reorder point
  - Read plant maintenance data (equipment BOMs, where-used reports)
authentication: API Key + OAuth2
usage_in_skill:
  - Step 1: Extract inventory master and transaction data
  - Step 3: Extract purchase order and vendor performance data
  - Step 11: Upload optimized Min-Max parameters
```

### mcp-cmms
```yaml
name: "mcp-cmms"
server: "@vsc/cmms-mcp"
purpose: "Work order data for consumption pattern analysis"
capabilities:
  - Read work orders with material usage details
  - Read equipment register and equipment status
  - Link material consumption to failure modes and work order types
  - Query planned maintenance schedule for future material requirements
  - Validate equipment-to-material linkage
authentication: API Key + OAuth2
usage_in_skill:
  - Step 1: Extract work order material consumption data
  - Step 2: Analyze consumption by failure mode and work order type
  - Step 7: Cross-reference materials against active equipment register
  - Step 12: Validate FMECA predictions against actual consumption
```

### mcp-excel
```yaml
name: "mcp-excel"
server: "@anthropic/excel-mcp"
purpose: "Analysis workbooks and reporting"
capabilities:
  - Create optimization analysis workbooks with multiple scenario sheets
  - Generate KPI dashboards with charts and conditional formatting
  - Perform EOQ calculations and sensitivity analysis
  - Create excess/obsolete inventory disposition reports
  - Export formatted reports for stakeholder distribution
authentication: OAuth2 (Microsoft 365)
usage_in_skill:
  - Steps 4-8: Build analysis workbooks with optimization calculations
  - Step 9: Generate KPI dashboard and trend reports
  - Step 10: Create action plan with financial impact analysis
```

---

## Templates & References

### Templates
- `templates/mro_optimization_report_template.xlsx` -- Standard optimization report workbook
- `templates/minmax_calculation_template.xlsx` -- Min-Max parameter calculation workbook
- `templates/eoq_analysis_template.xlsx` -- EOQ analysis with sensitivity analysis
- `templates/excess_obsolete_review_template.xlsx` -- Excess and obsolete inventory review form
- `templates/inventory_kpi_dashboard_template.xlsx` -- Monthly KPI dashboard template
- `templates/erp_parameter_upload_SAP.xlsx` -- SAP MM MRP parameter upload format
- `templates/disposition_approval_form.docx` -- Excess inventory disposition approval form

### Reference Documents
- SMRP Best Practice 5.5 series -- MRO Inventory Management
- ISO 55001:2014 -- Asset Management Systems
- APICS/ASCM Inventory Management Body of Knowledge
- "MRO Inventory Optimization" (Plant Engineering, 2022)
- Deloitte MRO Inventory Study (2021)
- VSC Corporate Pain Points Research Report -- P-03, D-04

### Reference Datasets
- SMRP MRO inventory benchmark database (by industry sector)
- Standard carrying cost rates by industry (25-35% typical)
- Standard ordering cost per PO (by organization maturity)
- Commodity price indices for major MRO materials

---

## Examples

### Example 1: Quarterly MRO Inventory Optimization

```
Command: optimize-mro-inventory analyze --site "MDP" --period 12

Process:
  Step 1: Data Extraction
    - Material master: 11,247 items (from K-01 initial list)
    - Current inventory value: $52.3M
    - RAV: $4.5B -> Inventory at 1.16% RAV (within benchmark)
    - Transaction history: 18 months of data (47,234 transactions)

  Step 2: Consumption Analysis
    - Fast-moving: 2,112 items (19%) -- 78% of annual consumption value
    - Slow-moving: 3,485 items (31%) -- 15% of annual consumption value
    - Intermittent: 2,893 items (26%) -- 6% of annual consumption value
    - Non-moving: 1,842 items (16%) -- 1% of annual consumption value
    - Dead stock: 915 items (8%) -- 0% consumption, $3.8M in value

  Step 5: Min-Max Optimization
    - 4,215 items recommended for parameter adjustment
    - Net impact: -$4.2M in average inventory reduction (safety stock optimization)
    - Service level maintained at >95% for all V and E items

  Step 6: EOQ Analysis (A-class items)
    - 387 items analyzed, 285 with suboptimal order quantities
    - Annual ordering cost savings: $127K
    - Annual carrying cost savings: $312K
    - Net savings from EOQ: $439K/year

  Step 7: Excess & Obsolete
    Excess inventory identified:
    - 1,247 items with >24 months supply: $6.8M value
    - 412 items with >36 months supply: $3.2M value (immediate action)
    - Recommended disposition: return $1.1M, sell $0.8M, write-off $1.3M

    Obsolete inventory identified:
    - 183 items linked to decommissioned equipment: $1.4M value
    - 67 items superseded by vendor: $0.6M value
    - Total obsolete: 250 items, $2.0M value

  Summary:
    | Optimization Action | Annual Value |
    |--------------------|----|
    | Min-Max parameter update | $1.05M/yr carrying cost reduction |
    | EOQ implementation | $0.44M/yr savings |
    | Excess disposition | $2.4M one-time recovery + $0.6M/yr carrying |
    | Obsolete disposition | $2.0M one-time recovery + $0.5M/yr carrying |
    | **Total Year-1 Impact** | **$7.0M** |

    Revised inventory value: $52.3M -> $45.5M (-13%)
    Revised RAV percentage: 1.16% -> 1.01% (improved, approaching top quartile)

Output:
  "MDP MRO Inventory Optimization Complete.
   Current inventory: $52.3M (1.16% RAV).
   Optimization opportunity: $7.0M Year-1 impact.
   Key actions:
   1. Update Min-Max parameters on 4,215 items (saves $1.05M/yr)
   2. Dispose $4.4M in excess/obsolete inventory
   3. Implement EOQ for 285 fast-moving items (saves $0.44M/yr)
   4. 915 dead stock items requiring review
   Revised inventory target: $45.5M (1.01% RAV, top quartile)
   Report: MDP_MRO_Optimization_Report_v1.0_20260601.xlsx"
```

### Example 2: Stockout Root Cause Analysis and Corrective Action

```
Trigger: Stockout event on mechanical seal for Pump PP-3201A

Analysis:
  Item: Mechanical seal cartridge, John Crane Type 4610
  Equipment: PP-3201A (Cyclone Feed Pump, Criticality A)
  Classification: V-A (Vital, High-value)

  Current Parameters:
  - Min stock: 1 | Max stock: 3 | On hand: 0
  - Last receipt: 8 months ago (qty 2)
  - Consumption last 12 months: 4 units (vs. FMECA prediction: 2/year)
  - Lead time: 12 weeks (quoted: 8 weeks, actual average: 12 weeks)

  Root Cause:
  1. Demand exceeded FMECA prediction by 100% (actual: 4/yr vs predicted: 2/yr)
  2. Lead time exceeded quoted by 50% (actual: 12 weeks vs quoted: 8 weeks)
  3. Min stock of 1 with 12-week lead time and 4/yr consumption was insufficient
     Required Min = (4/52 * 12 * 7) + Safety Stock = 6.5 + 3.2 = 10 units (!!!)
     -- clearly the item should be stocked at higher level or have consignment

  Corrective Actions:
  1. IMMEDIATE: Emergency PO placed for 3 units (expedited 4-week delivery, $8K premium)
  2. SHORT-TERM: Update Min to 3, Max to 6 (based on actual consumption and lead time)
  3. MEDIUM-TERM: Flag to J-01 (maintenance strategy) that seal failure rate is 2x prediction
     -> potential root cause: incorrect seal material, installation quality, operating condition
  4. LONG-TERM: Negotiate vendor-managed inventory (VMI) agreement with John Crane for
     high-consumption seal items

  Financial Impact:
  - Pump downtime: 18 hours (changeover to standby pump: 2 hours, but standby was
    already in service -> 18 hours until emergency seal arrived from Santiago)
  - Production loss: 18 hours x $62K/hour = $1.12M
  - Emergency procurement premium: $8K
  - Total stockout cost: $1.13M
  - Cost to prevent (carry 3 additional seals): $4.5K/year
  - Benefit/Cost ratio of proper stocking: 251:1

Output:
  "STOCKOUT ALERT - Mechanical seal PP-3201A
   Production loss: $1.12M (18 hours)
   Root cause: Demand 2x FMECA prediction + lead time 50% longer than quoted
   Corrective: Min-Max updated 1/3 -> 3/6. Emergency PO placed.
   Maintenance strategy review flagged: seal failure rate anomaly.
   Prevention cost of proper stocking: $4.5K/yr vs $1.13M stockout cost."
```
